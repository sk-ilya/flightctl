<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for FlightCtl - Fleet management for edge devices"><link href=https://flightctl.github.io/flightctl/user/managing-devices/ rel=canonical><link href=../install-cli/ rel=prev><link href=../managing-fleets/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.15"><title>Managing Devices - FlightCtl Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#managing-devices class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="FlightCtl Documentation" class="md-header__button md-logo" aria-label="FlightCtl Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FlightCtl Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Managing Devices </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=blue aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/flightctl/flightctl title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> flightctl/flightctl </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../developer/ class=md-tabs__link> Developer Guide </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="FlightCtl Documentation" class="md-nav__button md-logo" aria-label="FlightCtl Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> FlightCtl Documentation </label> <div class=md-nav__source> <a href=https://github.com/flightctl/flightctl title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> flightctl/flightctl </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../install-cli/ class=md-nav__link> <span class=md-ellipsis> Install CLI </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Managing Devices </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Managing Devices </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enrolling-devices class=md-nav__link> <span class=md-ellipsis> Enrolling Devices </span> </a> <nav class=md-nav aria-label="Enrolling Devices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enrolling-using-the-web-ui class=md-nav__link> <span class=md-ellipsis> Enrolling using the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#enrolling-using-the-cli class=md-nav__link> <span class=md-ellipsis> Enrolling using the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#viewing-and-customizing-the-device-system-information class=md-nav__link> <span class=md-ellipsis> Viewing and Customizing the Device System Information </span> </a> <nav class=md-nav aria-label="Viewing and Customizing the Device System Information"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#considerations-for-system-information class=md-nav__link> <span class=md-ellipsis> Considerations for System Information </span> </a> </li> <li class=md-nav__item> <a href=#viewing-using-the-web-ui class=md-nav__link> <span class=md-ellipsis> Viewing using the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#viewing-using-the-cli class=md-nav__link> <span class=md-ellipsis> Viewing using the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#organizing-devices class=md-nav__link> <span class=md-ellipsis> Organizing Devices </span> </a> <nav class=md-nav aria-label="Organizing Devices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-labels-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Using Labels on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#using-labels-on-the-cli class=md-nav__link> <span class=md-ellipsis> Using Labels on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#updating-the-os class=md-nav__link> <span class=md-ellipsis> Updating the OS </span> </a> <nav class=md-nav aria-label="Updating the OS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#updating-the-os-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Updating the OS on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#updating-the-os-on-the-cli class=md-nav__link> <span class=md-ellipsis> Updating the OS on the CLI </span> </a> </li> <li class=md-nav__item> <a href=#using-image-pull-secrets class=md-nav__link> <span class=md-ellipsis> Using Image Pull Secrets </span> </a> <nav class=md-nav aria-label="Using Image Pull Secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#auth-file-format class=md-nav__link> <span class=md-ellipsis> Auth File Format </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#managing-os-configuration class=md-nav__link> <span class=md-ellipsis> Managing OS Configuration </span> </a> <nav class=md-nav aria-label="Managing OS Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-configuration-from-a-git-repository class=md-nav__link> <span class=md-ellipsis> Getting Configuration from a Git Repository </span> </a> <nav class=md-nav aria-label="Getting Configuration from a Git Repository"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example class=md-nav__link> <span class=md-ellipsis> Example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-secrets-from-a-kubernetes-cluster class=md-nav__link> <span class=md-ellipsis> Getting Secrets from a Kubernetes Cluster </span> </a> </li> <li class=md-nav__item> <a href=#getting-configuration-from-an-http-server class=md-nav__link> <span class=md-ellipsis> Getting Configuration from an HTTP Server </span> </a> </li> <li class=md-nav__item> <a href=#specifying-configuration-inline-in-the-device-spec class=md-nav__link> <span class=md-ellipsis> Specifying Configuration Inline in the Device Spec </span> </a> </li> <li class=md-nav__item> <a href=#managing-configuration-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Managing Configuration on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#managing-configuration-on-the-cli class=md-nav__link> <span class=md-ellipsis> Managing Configuration on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#managing-applications class=md-nav__link> <span class=md-ellipsis> Managing Applications </span> </a> <nav class=md-nav aria-label="Managing Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#runtime-podman class=md-nav__link> <span class=md-ellipsis> Runtime: Podman </span> </a> </li> <li class=md-nav__item> <a href=#managing-applications-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Managing Applications on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#managing-applications-on-the-cli class=md-nav__link> <span class=md-ellipsis> Managing Applications on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-applications class=md-nav__link> <span class=md-ellipsis> Creating Applications </span> </a> <nav class=md-nav aria-label="Creating Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creating-oci-registry-application-package class=md-nav__link> <span class=md-ellipsis> Creating OCI Registry Application Package </span> </a> </li> <li class=md-nav__item> <a href=#specifying-applications-inline-in-the-device-spec class=md-nav__link> <span class=md-ellipsis> Specifying Applications Inline in the Device Spec </span> </a> </li> <li class=md-nav__item> <a href=#adding-application-volumes class=md-nav__link> <span class=md-ellipsis> Adding Application Volumes </span> </a> <nav class=md-nav aria-label="Adding Application Volumes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifying-volumes class=md-nav__link> <span class=md-ellipsis> Specifying Volumes </span> </a> </li> <li class=md-nav__item> <a href=#example-inline-application-with-volume class=md-nav__link> <span class=md-ellipsis> Example Inline Application with Volume </span> </a> </li> <li class=md-nav__item> <a href=#oci-artifact-requirements class=md-nav__link> <span class=md-ellipsis> OCI Artifact Requirements </span> </a> </li> <li class=md-nav__item> <a href=#device-requirements class=md-nav__link> <span class=md-ellipsis> Device Requirements </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#using-device-lifecycle-hooks class=md-nav__link> <span class=md-ellipsis> Using Device Lifecycle Hooks </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-device-resources class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources </span> </a> <nav class=md-nav aria-label="Monitoring Device Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monitoring-device-resources-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-device-resources-on-the-cli class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-devices-remotely class=md-nav__link> <span class=md-ellipsis> Accessing Devices Remotely </span> </a> <nav class=md-nav aria-label="Accessing Devices Remotely"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accessing-devices-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Accessing Devices on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#accessing-devices-on-the-cli class=md-nav__link> <span class=md-ellipsis> Accessing Devices on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decommissioning-devices class=md-nav__link> <span class=md-ellipsis> Decommissioning Devices </span> </a> </li> <li class=md-nav__item> <a href=#scheduling-updates-and-downloads class=md-nav__link> <span class=md-ellipsis> Scheduling Updates and Downloads </span> </a> <nav class=md-nav aria-label="Scheduling Updates and Downloads"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../managing-fleets/ class=md-nav__link> <span class=md-ellipsis> Managing Fleets </span> </a> </li> <li class=md-nav__item> <a href=../provisioning-devices/ class=md-nav__link> <span class=md-ellipsis> Provisioning Devices </span> </a> </li> <li class=md-nav__item> <a href=../building-images/ class=md-nav__link> <span class=md-ellipsis> Building Images </span> </a> </li> <li class=md-nav__item> <a href=../configuring-agent/ class=md-nav__link> <span class=md-ellipsis> Configuring Agent </span> </a> </li> <li class=md-nav__item> <a href=../api-resources/ class=md-nav__link> <span class=md-ellipsis> API Resources </span> </a> </li> <li class=md-nav__item> <a href=../auth-resources/ class=md-nav__link> <span class=md-ellipsis> Auth Resources </span> </a> </li> <li class=md-nav__item> <a href=../device-api-statuses/ class=md-nav__link> <span class=md-ellipsis> Device API Statuses </span> </a> </li> <li class=md-nav__item> <a href=../field-selectors/ class=md-nav__link> <span class=md-ellipsis> Field Selectors </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes-auth/ class=md-nav__link> <span class=md-ellipsis> Kubernetes Auth </span> </a> </li> <li class=md-nav__item> <a href=../registering-microshift-devices-acm/ class=md-nav__link> <span class=md-ellipsis> Registering MicroShift Devices ACM </span> </a> </li> <li class=md-nav__item> <a href=../disconnected-cluster/ class=md-nav__link> <span class=md-ellipsis> Disconnected Cluster </span> </a> </li> <li class=md-nav__item> <a href=../alerts/ class=md-nav__link> <span class=md-ellipsis> Alerts </span> </a> </li> <li class=md-nav__item> <a href=../security-guidelines/ class=md-nav__link> <span class=md-ellipsis> Security Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../network-requirements/ class=md-nav__link> <span class=md-ellipsis> Network Requirements </span> </a> </li> <li class=md-nav__item> <a href=../database-migration/ class=md-nav__link> <span class=md-ellipsis> Database Migration </span> </a> </li> <li class=md-nav__item> <a href=../service-observability/ class=md-nav__link> <span class=md-ellipsis> Service Observability </span> </a> </li> <li class=md-nav__item> <a href=../standalone-observability/ class=md-nav__link> <span class=md-ellipsis> Standalone Observability </span> </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../developer/ class=md-nav__link> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enrolling-devices class=md-nav__link> <span class=md-ellipsis> Enrolling Devices </span> </a> <nav class=md-nav aria-label="Enrolling Devices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enrolling-using-the-web-ui class=md-nav__link> <span class=md-ellipsis> Enrolling using the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#enrolling-using-the-cli class=md-nav__link> <span class=md-ellipsis> Enrolling using the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#viewing-and-customizing-the-device-system-information class=md-nav__link> <span class=md-ellipsis> Viewing and Customizing the Device System Information </span> </a> <nav class=md-nav aria-label="Viewing and Customizing the Device System Information"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#considerations-for-system-information class=md-nav__link> <span class=md-ellipsis> Considerations for System Information </span> </a> </li> <li class=md-nav__item> <a href=#viewing-using-the-web-ui class=md-nav__link> <span class=md-ellipsis> Viewing using the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#viewing-using-the-cli class=md-nav__link> <span class=md-ellipsis> Viewing using the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#organizing-devices class=md-nav__link> <span class=md-ellipsis> Organizing Devices </span> </a> <nav class=md-nav aria-label="Organizing Devices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-labels-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Using Labels on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#using-labels-on-the-cli class=md-nav__link> <span class=md-ellipsis> Using Labels on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#updating-the-os class=md-nav__link> <span class=md-ellipsis> Updating the OS </span> </a> <nav class=md-nav aria-label="Updating the OS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#updating-the-os-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Updating the OS on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#updating-the-os-on-the-cli class=md-nav__link> <span class=md-ellipsis> Updating the OS on the CLI </span> </a> </li> <li class=md-nav__item> <a href=#using-image-pull-secrets class=md-nav__link> <span class=md-ellipsis> Using Image Pull Secrets </span> </a> <nav class=md-nav aria-label="Using Image Pull Secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#auth-file-format class=md-nav__link> <span class=md-ellipsis> Auth File Format </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#managing-os-configuration class=md-nav__link> <span class=md-ellipsis> Managing OS Configuration </span> </a> <nav class=md-nav aria-label="Managing OS Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-configuration-from-a-git-repository class=md-nav__link> <span class=md-ellipsis> Getting Configuration from a Git Repository </span> </a> <nav class=md-nav aria-label="Getting Configuration from a Git Repository"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example class=md-nav__link> <span class=md-ellipsis> Example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-secrets-from-a-kubernetes-cluster class=md-nav__link> <span class=md-ellipsis> Getting Secrets from a Kubernetes Cluster </span> </a> </li> <li class=md-nav__item> <a href=#getting-configuration-from-an-http-server class=md-nav__link> <span class=md-ellipsis> Getting Configuration from an HTTP Server </span> </a> </li> <li class=md-nav__item> <a href=#specifying-configuration-inline-in-the-device-spec class=md-nav__link> <span class=md-ellipsis> Specifying Configuration Inline in the Device Spec </span> </a> </li> <li class=md-nav__item> <a href=#managing-configuration-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Managing Configuration on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#managing-configuration-on-the-cli class=md-nav__link> <span class=md-ellipsis> Managing Configuration on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#managing-applications class=md-nav__link> <span class=md-ellipsis> Managing Applications </span> </a> <nav class=md-nav aria-label="Managing Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#runtime-podman class=md-nav__link> <span class=md-ellipsis> Runtime: Podman </span> </a> </li> <li class=md-nav__item> <a href=#managing-applications-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Managing Applications on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#managing-applications-on-the-cli class=md-nav__link> <span class=md-ellipsis> Managing Applications on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-applications class=md-nav__link> <span class=md-ellipsis> Creating Applications </span> </a> <nav class=md-nav aria-label="Creating Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creating-oci-registry-application-package class=md-nav__link> <span class=md-ellipsis> Creating OCI Registry Application Package </span> </a> </li> <li class=md-nav__item> <a href=#specifying-applications-inline-in-the-device-spec class=md-nav__link> <span class=md-ellipsis> Specifying Applications Inline in the Device Spec </span> </a> </li> <li class=md-nav__item> <a href=#adding-application-volumes class=md-nav__link> <span class=md-ellipsis> Adding Application Volumes </span> </a> <nav class=md-nav aria-label="Adding Application Volumes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifying-volumes class=md-nav__link> <span class=md-ellipsis> Specifying Volumes </span> </a> </li> <li class=md-nav__item> <a href=#example-inline-application-with-volume class=md-nav__link> <span class=md-ellipsis> Example Inline Application with Volume </span> </a> </li> <li class=md-nav__item> <a href=#oci-artifact-requirements class=md-nav__link> <span class=md-ellipsis> OCI Artifact Requirements </span> </a> </li> <li class=md-nav__item> <a href=#device-requirements class=md-nav__link> <span class=md-ellipsis> Device Requirements </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#using-device-lifecycle-hooks class=md-nav__link> <span class=md-ellipsis> Using Device Lifecycle Hooks </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-device-resources class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources </span> </a> <nav class=md-nav aria-label="Monitoring Device Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monitoring-device-resources-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#monitoring-device-resources-on-the-cli class=md-nav__link> <span class=md-ellipsis> Monitoring Device Resources on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-devices-remotely class=md-nav__link> <span class=md-ellipsis> Accessing Devices Remotely </span> </a> <nav class=md-nav aria-label="Accessing Devices Remotely"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accessing-devices-on-the-web-ui class=md-nav__link> <span class=md-ellipsis> Accessing Devices on the Web UI </span> </a> </li> <li class=md-nav__item> <a href=#accessing-devices-on-the-cli class=md-nav__link> <span class=md-ellipsis> Accessing Devices on the CLI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decommissioning-devices class=md-nav__link> <span class=md-ellipsis> Decommissioning Devices </span> </a> </li> <li class=md-nav__item> <a href=#scheduling-updates-and-downloads class=md-nav__link> <span class=md-ellipsis> Scheduling Updates and Downloads </span> </a> <nav class=md-nav aria-label="Scheduling Updates and Downloads"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/flightctl/flightctl/edit/master/docs/user/managing-devices.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/flightctl/flightctl/raw/master/docs/user/managing-devices.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=managing-devices>Managing Devices<a class=headerlink href=#managing-devices title="Permanent link">&para;</a></h1> <h2 id=enrolling-devices>Enrolling Devices<a class=headerlink href=#enrolling-devices title="Permanent link">&para;</a></h2> <p>The first time the Flight Control Agent runs, it generates a cryptographic key pair that serves as the device's unique cryptographic identity. The pair's private key never leaves the device, so that the device cannot be duplicated or impersonated. The cryptographic identity is registered with the Flight Control Service during enrollment and gets wiped during device decommissioning.</p> <p>When the device is not yet enrolled, the agent performs service discovery to find its Flight Control Service instance. It then establishes a secure, mTLS-protected network connection to the Service using the X.509 enrollment certificate it has been provided with during image building or device provisioning. Next, it submits an Enrollment Request to the service that includes a description of the device's hardware and operating system as well as an X.509 Certificate Signing Request (CSR) including its cryptographic identity to obtain its initial management certificate. At this point, the device is not yet considered trusted and therefore remains quarantined in a "device lobby" until its Enrollment Request has been approved or denied by an authorized user (e.g. a administrator, an installer persona, or an auto-approver process).</p> <h3 id=enrolling-using-the-web-ui>Enrolling using the Web UI<a class=headerlink href=#enrolling-using-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=enrolling-using-the-cli>Enrolling using the CLI<a class=headerlink href=#enrolling-using-the-cli title="Permanent link">&para;</a></h3> <p>You can list all devices currently waiting to be approved by running the following command:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=go>flightctl get enrollmentrequests</span>
</span></code></pre></div> <p>The output should look similar to this:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=go>NAME                                                  APPROVAL  APPROVER  APPROVED LABELS</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  Pending   &lt;none&gt;    &lt;none&gt;    </span>
</span></code></pre></div> <p>The unique device name is generated by the agent and cannot be changed. By default, the agent chooses the "device fingerprint", a base32-encoded hash of the agent's public key, as device name.</p> <p>You can approve an Enrollment Request using the <code>flightctl approve</code> command and the name of the Enrollment Request to be approved. You can optionally also add labels to the device (see <a href=#organizing-devices>Organizing Devices</a>) using the <code>--label</code> or <code>-l</code> flag. For example:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=go>flightctl approve -l region=eu-west-1 -l site=factory-berlin enrollmentrequest/54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg</span>
</span></code></pre></div> <p>When listing devices waiting to be approved once more using the <code>flightctl get enrollmentrequests</code> command, the output should look similar to this:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=go>NAME                                                  APPROVAL  APPROVER  APPROVED LABELS</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  Approved  demouser  region=eu-west-1,site=factory-berlin</span>
</span></code></pre></div> <p>Once approved, the device will get issued its initial management certificate and get registered to the device inventory and is now ready to be managed.</p> <h2 id=viewing-and-customizing-the-device-system-information>Viewing and Customizing the Device System Information<a class=headerlink href=#viewing-and-customizing-the-device-system-information title="Permanent link">&para;</a></h2> <p>Flight Control automatically gathers system information from each device to help identify its hardware, OS, and environment. This data is shown in the <code>status.systemInfo</code> field. Fields can optionally be promoted to labels during the enrollment process, this must be done manually or through external automation. Promoting fields to labels enables powerful grouping and querying capabilities, such as filtering devices by region or OS version. You can also define your own fields in <code>status.systemInfo.customInfo</code>, allowing the agent to collect user-defined metadata through custom commands.</p> <h3 id=considerations-for-system-information>Considerations for System Information<a class=headerlink href=#considerations-for-system-information title="Permanent link">&para;</a></h3> <p>Here are key considerations when using this feature:</p> <ul> <li> <p><strong>Whatâ€™s Collected</strong>: By default, the agent collects basic system information such as hostname, kernel version, OS distribution, product identifiers, and default network interface details. Additional fields such as BIOS data, GPU info, memory, and CPU details can be enabled through configuration. See <a href=../configuring-agent/ >configuring agent</a> for a full list of supported fields and how to customize collection.</p> </li> <li> <p><strong>Custom Fields</strong>: You can configure the agent to collect additional custom attributes specific to your environment. These are displayed under <code>systemInfo.customInfo</code> and can be used for labeling or grouping devices. See <a href=../configuring-agent/ >configuring agent</a> for example usage.</p> </li> <li> <p><strong>Collection Timing</strong>: System info is collected during process bootstrap and then cached. It refreshes only if the agent restarts or receives a reload signal (SIGHUP). This avoids unnecessary overhead during regular status updates.</p> </li> <li> <p><strong>Reboot Awareness</strong>: The agent tracks boot time and boot ID, allowing Flight Control to detect whether the device has rebooted. This is useful for update coordination and lifecycle monitoring.</p> </li> <li> <p><strong>Partial Data</strong>: Not all fields may be available on every device or on every process start. Collection is best-effort missing values errors or timeouts will result in empty values.</p> </li> </ul> <h3 id=viewing-using-the-web-ui>Viewing using the Web UI<a class=headerlink href=#viewing-using-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=viewing-using-the-cli>Viewing using the CLI<a class=headerlink href=#viewing-using-the-cli title="Permanent link">&para;</a></h3> <p>You can see the devices in the device inventory by running the following command:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>flightctl get devices</span>
</span></code></pre></div> <p>The output will be a table similar to this:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=go>NAME                                                  ALIAS    OWNER   SYSTEM  UPDATED     APPLICATIONS  LAST SEEN</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        3 seconds ago</span>
</span></code></pre></div> <p>You can see the details of this device in YAML format by running the following command:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=go>flightctl get device/54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg -o yaml</span>
</span></code></pre></div> <p>The output will look similar to this:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>                                    </span><span class=c1># &lt;-- user-defined labels assigned to this device</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">eu-west-1</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>    </span><span class=nt>site</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">factory-berlin</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>  </span><span class=nt>os</span><span class=p>:</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/flightctl/rhel:9.5</span><span class=w>        </span><span class=c1># &lt;-- the device&#39;s target OS image version</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-os-configuration</span><span class=w>                </span><span class=c1># &lt;-- the device&#39;s target OS configuration (here: read from a git repo)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>    </span><span class=nt>configType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GitConfigProviderSpec</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>    </span><span class=nt>gitRef</span><span class=p>:</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/configuration</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>      </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-configuration-repo</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>      </span><span class=nt>targetRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=nt>status</span><span class=p>:</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>  </span><span class=nt>os</span><span class=p>:</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/flightctl/rhel:9.5</span><span class=w>        </span><span class=c1># &lt;-- the device&#39;s current OS image version</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>    </span><span class=nt>renderedVersion</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1&quot;</span><span class=w>                     </span><span class=c1># &lt;-- the device&#39;s current OS configuration version</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>  </span><span class=nt>applications</span><span class=p>:</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>    </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span><span class=w>                                 </span><span class=c1># &lt;-- the device&#39;s current list of deployed applications</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=w>    </span><span class=nt>summary</span><span class=p>:</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=w>      </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Unknown</span><span class=w>                        </span><span class=c1># &lt;-- health status of applications on the device</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>                                 </span><span class=c1># &lt;-- whether sufficient CPU/disk/memory resources are available</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Healthy</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=w>    </span><span class=nt>disk</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Healthy</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Healthy</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=w>  </span><span class=nt>systemInfo</span><span class=p>:</span><span class=w>                                </span><span class=c1># &lt;-- basic information about the system</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=w>    </span><span class=nt>architecture</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">amd64</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=w>    </span><span class=nt>bootID</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">037750f7-f293-4c5b-b06e-481eef4e883f</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=w>    </span><span class=nt>operatingSystem</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">linux</span>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=w>  </span><span class=nt>summary</span><span class=p>:</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a><span class=w>    </span><span class=nt>info</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a><span class=w>    </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Online</span><span class=w>                           </span><span class=c1># &lt;-- online status of the device</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a><span class=w>  </span><span class=nt>updated</span><span class=p>:</span>
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a><span class=w>    </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">UpToDate</span><span class=w>                         </span><span class=c1># &lt;-- update status of the device</span>
</span><span id=__span-7-40><a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a><span class=w>  </span><span class=nt>lastSeen</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2024-08-28T11:45:34.812851905Z&quot;</span><span class=w> </span><span class=c1># &lt;-- when the device last checked-in</span>
</span><span id=__span-7-41><a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <h2 id=organizing-devices>Organizing Devices<a class=headerlink href=#organizing-devices title="Permanent link">&para;</a></h2> <p>You can organize your devices by assigning them labels, for example to record their location ( ("region=emea", "site=factory-berlin"), hardware type ("hw-model=jetson", "hw-generation=orin"), or purpose ("device-type=autonomous-forklift"). This then allows you select devices by these labels when viewing the device inventory or applying operations to them.</p> <p>As good practice, labels should take the form of <code>key=value</code> pairs, whereby the key is the criterion you want to group by. However, labels that only consist of keys are also allowed.</p> <p>Labels must follow certain rules to be valid (in fact, these are the same as for <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/ >Kubernetes</a>):</p> <ul> <li>Keys and value must each be 63 characters or less. Value may be omitted.</li> <li>Keys and values may consist of alphanumeric characters (<code>a-z</code>, <code>A-Z</code>, <code>0-9</code>). They may also contain dashes (<code>-</code>), underscores (<code>_</code>), dots (<code>.</code>), but not as the first or last character.</li> </ul> <p>Once devices are labeled, you can select a subset of devices by writing a "label selector". Label selectors can select based on equality, inequality, or set operators:</p> <table> <thead> <tr> <th>Example label selector</th> <th>Devices it selects</th> </tr> </thead> <tbody> <tr> <td><code>site=factory-berlin</code></td> <td>All devices with a label key <code>site</code> and a label value <code>factory-berlin</code>.</td> </tr> <tr> <td><code>site!=factory-berlin</code></td> <td>All devices with a label key <code>site</code> and not a label value <code>factory-berlin</code>.</td> </tr> <tr> <td><code>site in (factory-berlin,factory-madrid)</code></td> <td>All devices with a label key <code>site</code> and a label value of either <code>factory-berlin</code> or <code>factory-madrid</code></td> </tr> </tbody> </table> <p>You can specify multiple label selectors in a comma-separated list, for example <code>site=factory-berlin,device-type=autonomous-forklift</code>, to have a device selected only if all selectors in the list match.</p> <p>There are multiple ways when and how to apply labels to devices:</p> <ul> <li>You can define a set of default labels during image building that get automatically applied to all devices deploying that image.</li> <li>You can assign initial labels during enrollment (see <a href=./#enrolling-devices>Enrolling Devices</a>).</li> <li>You can edit labels post-enrollment, which is described in the following sections.</li> </ul> <h3 id=using-labels-on-the-web-ui>Using Labels on the Web UI<a class=headerlink href=#using-labels-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=using-labels-on-the-cli>Using Labels on the CLI<a class=headerlink href=#using-labels-on-the-cli title="Permanent link">&para;</a></h3> <p>You can view devices in your inventory including their labels by using the <code>-o wide</code> option:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=go>flightctl get devices -o wide</span>
</span></code></pre></div> <div class="language-console highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=go>NAME                                                  ALIAS    OWNER   SYSTEM  UPDATED     APPLICATIONS  LAST SEEN      LABELS</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        3 seconds ago  region=eu-west-1,site=factory-berlin</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=go>hnsu33339f8m5pjqrbh5ak704jjp92r95a83sd5ja8cjnsl7qnrg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        1 minute ago   region=eu-west-1,site=factory-madrid</span>
</span></code></pre></div> <p>You can view devices in your inventory with a specific label or set of labels by using the <code>-l key=value</code> option one or more times:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=go>flightctl get devices -l site=factory-berlin -o wide</span>
</span></code></pre></div> <div class="language-console highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=go>NAME                                                  ALIAS    OWNER   SYSTEM  UPDATED     APPLICATIONS  LAST SEEN      LABELS</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        3 seconds ago  region=eu-west-1,site=factory-berlin</span>
</span></code></pre></div> <p>You can update the labels of a given device by exporting the device's current definition into a file, editing the specification to update the labels, and then applying the updated definition. To export the device's current definition into a file called <code>my_device.yaml</code>, run the <code>flightctl get device</code> command with the device's name and the <code>-o yaml</code> output flag:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=go>flightctl get device/54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg -o yaml &gt; my_device.yaml</span>
</span></code></pre></div> <p>Next, use your preferred editor to edit <code>my_device.yaml</code>, for example:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span><span class=nt>some_key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_value</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>    </span><span class=nt>some_other_key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_other_value</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <p>Save the edit, then apply the updated device definition using:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=go>flightctl apply -f my_device.yaml</span>
</span></code></pre></div> <p>When you now view the device's labels using <code>flightctl get devices -o wide</code> once more, you should see your changes applied:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=go>NAME                                                  ALIAS    OWNER   SYSTEM  UPDATED     APPLICATIONS  LAST SEEN      LABELS</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=go>54shovu028bvj6stkovjcvovjgo0r48618khdd5huhdjfn6raskg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        3 minutes ago  some_key=some_value,some_other_key=some_other_value</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=go>hnsu33339f8m5pjqrbh5ak704jjp92r95a83sd5ja8cjnsl7qnrg  &lt;none&gt;   &lt;none&gt;  Online  Up-to-date  &lt;none&gt;        4 minutes ago  region=eu-west-1,site=factory-madrid</span>
</span></code></pre></div> <h2 id=updating-the-os>Updating the OS<a class=headerlink href=#updating-the-os title="Permanent link">&para;</a></h2> <p>You can update a device's OS by updating the target OS image name or version in the device's specification. The next time the agent checks in, it learns of the requested update and automatically starts downloading and verifying the new OS version in the background. It then schedules the actual system update to be performed according to the update policy. When the time has come to update, it installs the new version in parallel and performs a reboot into the new version.</p> <p>Flight Control currently supports the following image types and image references formats:</p> <table> <thead> <tr> <th>Image Type</th> <th>Image Reference</th> </tr> </thead> <tbody> <tr> <td><a href=https://github.com/containers/bootc>bootc</a></td> <td>An OCI image reference to a container registry. Example: <code>quay.io/flightctl-demos/rhel:9.5</code></td> </tr> </tbody> </table> <p>During the process, the agent sends status updates to the service. You can monitor the update progress by viewing the device status.</p> <h3 id=updating-the-os-on-the-web-ui>Updating the OS on the Web UI<a class=headerlink href=#updating-the-os-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=updating-the-os-on-the-cli>Updating the OS on the CLI<a class=headerlink href=#updating-the-os-on-the-cli title="Permanent link">&para;</a></h3> <p>To update a device using the CLI, get the device's current resource manifest, edit it to specify the new OS name and version target, then apply the updated resource.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>  </span><span class=nt>os</span><span class=p>:</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/flightctl/rhel:9.5</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <h3 id=using-image-pull-secrets>Using Image Pull Secrets<a class=headerlink href=#using-image-pull-secrets title="Permanent link">&para;</a></h3> <p>If your device relies on containers from a private repository, <a href=https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_image_mode_for_rhel_to_build_deploy_and_manage_operating_systems/index#configuring-container-pull-secrets_managing-users-groups-ssh-key-and-secrets-in-image-mode-for-rhel>authentication credentials</a> (pull secrets) must be placed in the appropriate system paths.</p> <ul> <li><strong>OS Image:</strong> Uses <code>/etc/ostree/auth.json</code></li> <li><strong>Container Images:</strong> Uses the system default for Podman, <code>/root/.config/containers/auth.json</code></li> </ul> <h4 id=auth-file-format>Auth File Format<a class=headerlink href=#auth-file-format title="Permanent link">&para;</a></h4> <p>The authentication file should follow this format:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=p>{</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>  </span><span class=nt>&quot;auths&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>    </span><span class=nt>&quot;registry.example.com&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>      </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;base64-encoded-credentials&quot;</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=p>}</span>
</span></code></pre></div> <blockquote> <p>[!NOTE] Authentication must exist on the device before it can be consumed.</p> </blockquote> <h2 id=managing-os-configuration>Managing OS Configuration<a class=headerlink href=#managing-os-configuration title="Permanent link">&para;</a></h2> <p>With image-based Linux OSes, it is best practice to include OS-level / host configuration into the OS image for maximum consistency and repeatability. To update configuration, a new OS image should be created and devices updated to the new image.</p> <p>However, there are scenarios where this is impractical, for example, when configuration is missing in the image, needs to be specific to a device, or needs to be update-able at runtime without updating the OS image and rebooting. For these cases, Flight Control allows users to declare a set of configuration files that shall be present on the device's file system.</p> <p>Conceptually, this set of configuration files can be thought of as an additional, dynamic layer on top of the OS image's layers. The Flight Control Agent applies updates to this layer transactionally, ensuring that either all files have been successfully updated in the file system or have been returned to their pre-update state. Further, if the user updates both a devices OS and configuration set at the same time, the Flight Control Agent will first update the OS, then apply the specified configuration set on top.</p> <blockquote> <p>[!Important] After the Flight Control Agent has updated the configuration on disk, this configuration still needs to be <em>activated</em>. That means, running services need to reload the new configuration into memory for it to become effective. If the update involves a reboot, services will be restarted by systemd in the right order with the new configuration automatically. If the update does not involve a reboot, many services can detect changes to their configuration files and automatically reload them. When a service does not support this, you <a href=./#using-device-lifecycle-hooks>use Device Lifecycle Hooks</a> to specify rules like "if configuration file X has changed, run command Y". Also refer to this section for the set of default rules that the Flight Control Agent applies.</p> </blockquote> <p>Users can specify a list of configurations sets, in which case the Flight Control Agent applies the sets in sequence and on top of each other, such that in case of conflict the "last one wins".</p> <p>Configuration can come from multiple sources, called "configuration providers" in Flight Control. Flight Control currently supports the following configuration providers:</p> <ul> <li><strong>Git Config Provider:</strong> Fetches device configuration files from a Git repository.</li> <li><strong>Kubernetes Secret Provider:</strong> Fetches a Secret from a Kubernetes cluster and writes its content to the device's file system.</li> <li><strong>HTTP Config Provider:</strong> Fetches device configuration files from an HTTP(S) endpoint.</li> <li><strong>Inline Config Provider:</strong> Allows specifying device configuration files inline in the device manifest without querying external systems.</li> </ul> <p>These providers are described in the following.</p> <h3 id=getting-configuration-from-a-git-repository>Getting Configuration from a Git Repository<a class=headerlink href=#getting-configuration-from-a-git-repository title="Permanent link">&para;</a></h3> <p>You can store device configuration in a Git repository such as GitHub or GitLab and let Flight Control synchronize it to the device's file system by adding a Git Config Provider.</p> <p>The Git Config Provider takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Repository</td> <td>The name of a Repository resource defined in Flight Control.</td> </tr> <tr> <td>TargetRevision</td> <td>The branch, tag, or commit of the repository to checkout.</td> </tr> <tr> <td>Path</td> <td>The subdirectory of the repository that contains the configuration.</td> </tr> </tbody> </table> <p>The Repository resource definition tells Flight Control the Git repository to connect to and which protocol and access credentials to use. It needs to be set up once (see Setting Up Repositories) and can then be used to configure multiple devices or fleets.</p> <p>The subdirectory of the repository (pointed to by Path) will be mounted to the root of the device. When specifying a Path, make sure the directories in it already exist with writable access on the system (the application cannot write to the root).<br> Using non-existent or read-only directories may result in errors due to insufficient permissions or read-only file systems.</p> <h4 id=example>Example<a class=headerlink href=#example title="Permanent link">&para;</a></h4> <p>A assume a Git repository <code>github.com/flightctl/flightctl-demos</code> that in its branch <code>production</code> stores device network and time server configuration organized by deployment site as follows:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=go>.</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=go>â”œâ”€â”€ factory-a</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=go>â”‚Â Â  â””â”€â”€ etc</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=go>â”‚Â Â      â”œâ”€â”€ chrony.conf</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=go>â”‚Â Â      â””â”€â”€ NetworkManager</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=go>â”‚Â Â          â””â”€â”€ system-connections</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=go>â”‚Â Â              â””â”€â”€ wifi-access.nmconnection</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=go>â””â”€â”€ factory-b</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=go>    â””â”€â”€ etc</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=go>        â”œâ”€â”€ chrony.conf</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=go>        â””â”€â”€ NetworkManager</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=go>            â””â”€â”€ system-connections</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=go>                â””â”€â”€ wifi-access.nmconnection</span>
</span></code></pre></div> <p>First, create a new Repository resource. Give it a name that you can later reference in your configurations, for example "site-settings", and select the Repository type "git". Next, enter the URL of your git repository, in this case <code>https://github.com/flightctl/flightctl-demos.git</code>.</p> <p>You can now reference this Repository when you configure devices. For example, to apply the configuration files under <code>/factory-a</code> to a device, add a Git Config Provider to the device's specification using the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Repository</td> <td>site-settings</td> </tr> <tr> <td>TargetRevision</td> <td>production</td> </tr> <tr> <td>Path</td> <td>/factory-a</td> </tr> </tbody> </table> <h3 id=getting-secrets-from-a-kubernetes-cluster>Getting Secrets from a Kubernetes Cluster<a class=headerlink href=#getting-secrets-from-a-kubernetes-cluster title="Permanent link">&para;</a></h3> <p>You can let Flight Control query the Kubernetes cluster it is running on for a Kubernetes Secret. The content of that Secret can then be written to a path on the device file system.</p> <p>The Kubernetes Secret Provider takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Name</td> <td>The name of the Secret.</td> </tr> <tr> <td>NameSpace</td> <td>The namespace of the Secret.</td> </tr> <tr> <td>MountPath</td> <td>The directory in the device's file system to write the secret's content to.</td> </tr> </tbody> </table> <p>Note that Flight Control needs to have the permissions access Secrets in that namespace, for example by creating a ClusterRole and ClusterRoleBinding allowing the <code>flightctl-worker</code> service account "get" and "list" Secrets in that namespace.</p> <h3 id=getting-configuration-from-an-http-server>Getting Configuration from an HTTP Server<a class=headerlink href=#getting-configuration-from-an-http-server title="Permanent link">&para;</a></h3> <p>You can let Flight Control query an HTTP server for configuration. This HTTP server can then serve static or dynamically generated configuration for a device.</p> <p>The HTTP Config Provider takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Repository</td> <td>The name of a Repository resource defined in Flight Control.</td> </tr> <tr> <td>Suffix</td> <td>The suffix to append to the base URL defined in the Repository resource. It can include path and query parameters such as <code>/path/to/endpoint?query=param</code></td> </tr> <tr> <td>FilePath</td> <td>The path to the file on the device's file system in which to store the returned value of the HTTP Server.</td> </tr> </tbody> </table> <p>The Repository resource definition tells Flight Control the HTTP server to connect to and which protocol and access credentials to use. It needs to be set up once (see Setting Up Repositories) and can then be used to configure multiple devices or fleets.</p> <h3 id=specifying-configuration-inline-in-the-device-spec>Specifying Configuration Inline in the Device Spec<a class=headerlink href=#specifying-configuration-inline-in-the-device-spec title="Permanent link">&para;</a></h3> <p>You specify configuration inline in a device's specification, so Flight Control does not need to connect to external systems to fetch configuration.</p> <p>The Inline Config Provider takes a list of file specifications, whereby each file specification takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Path</td> <td>The absolute path to the file on the device. Note that any existing file will be overwritten.</td> </tr> <tr> <td>Content</td> <td>The plain text (UTF-8) or base64-encoded content of the file.</td> </tr> <tr> <td>ContentEncoding</td> <td>How the contents are encoded. Must be either "plain" or "base64". Defaults to "plain".</td> </tr> <tr> <td>Mode</td> <td>(Optional) The fileâ€™s permission mode. You may specify the more familiar octal with a leading zero (e.g., 0644) or as a decimal without a leading zero (e.g., 420). Setuid/setgid/sticky bits are supported. If not specified the permission mode for files defaults to 0644.</td> </tr> <tr> <td>User</td> <td>(Optional) The file's owner, specified either as a name or numeric ID. Defaults to "root".</td> </tr> <tr> <td>Group</td> <td>(Optional) The file's group, specified either as a name or numeric ID.</td> </tr> </tbody> </table> <h3 id=managing-configuration-on-the-web-ui>Managing Configuration on the Web UI<a class=headerlink href=#managing-configuration-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=managing-configuration-on-the-cli>Managing Configuration on the CLI<a class=headerlink href=#managing-configuration-on-the-cli title="Permanent link">&para;</a></h3> <p>To implement the example from <a href=./#getting-configuration-from-a-git-repository>Getting Configuration from a Git Repository</a>, first, create a file <code>site-settings-repo.yaml</code> that contains the following definition for a Repository resource named <code>site-settings</code>:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Repository</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">site-settings</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">git</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>  </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/flightctl/flightctl-demos.git</span>
</span></code></pre></div> <p>Create the Repository resource by applying the file:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=go>flightctl apply -f site-settings-repo.yaml`</span>
</span></code></pre></div> <p>Verify the resource has been correctly created and is accessible by Fight Control by running:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=go>flightctl get repository/site-settings</span>
</span></code></pre></div> <p>The output should look like this:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=go>NAME           TYPE  REPOSITORY URL                                ACCESSIBLE</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=go>site-settings  git   https://github.com/flightctl/flightctl-demos  True</span>
</span></code></pre></div> <p>To apply the configuration for <code>factory-a</code> to a device, you would update the device's specification as follows:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">factory-a-settings</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>    </span><span class=nt>configType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GitConfigProviderSpec</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>    </span><span class=nt>gitRef</span><span class=p>:</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=w>      </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">site-settings</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=w>      </span><span class=nt>targetRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/factory-a</span>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <h2 id=managing-applications>Managing Applications<a class=headerlink href=#managing-applications title="Permanent link">&para;</a></h2> <p>You can deploy, update, or undeploy applications on a device by updating the list of applications in the device's specification. The next time the agent checks in, it learns of the change in the specification, downloads any new or updated application packages and images from an OCI-compatible registry, and deploys them to the appropriate application runtime or removes them from that runtime.</p> <p>The following table shows the application runtimes and formats supported by Flight Control:</p> <h3 id=runtime-podman>Runtime: <strong>Podman</strong><a class=headerlink href=#runtime-podman title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Specification</th> <th>Format</th> <th>Source / Delivery</th> </tr> </thead> <tbody> <tr> <td>Compose specification (via <a href=https://github.com/containers/podman-compose><code>podman-compose</code></a>)</td> <td>OCI image</td> <td>OCI registry</td> </tr> <tr> <td>Compose specification (via <a href=https://github.com/containers/podman-compose><code>podman-compose</code></a>)</td> <td>Unpackaged inline</td> <td>Inline in device specification</td> </tr> </tbody> </table> <blockquote> <p>[!NOTE] Requires <code>podman-compose</code> to be installed on the device.</p> <p>[!TIP] Short image names (e.g., <code>nginx</code>) are not supported. Use fully qualified references like <code>docker.io/nginx</code> to avoid ambiguity.</p> </blockquote> <p>To deploy an application to a device, create a new entry in the "applications" section of the device's specification, specifying the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Name</td> <td>A user-defined name for the application. This will be used when the web UI and CLI list applications.</td> </tr> <tr> <td>Image</td> <td>A reference to an application package in an OCI registry.</td> </tr> <tr> <td>AppType</td> <td>The application format type. Currently supported type: <code>compose</code>.</td> </tr> <tr> <td>EnvVars</td> <td>(Optional) A list of key/value-pairs that will be passed to the deployment tool as environment variables or command line flags.</td> </tr> </tbody> </table> <p>For each application in the "applications" section of the device's specification, there exist a corresponding device status information that contains the following information:</p> <table> <thead> <tr> <th>Status Field</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Preparing</td> <td>Application deployed; containers initialized but not yet running.</td> </tr> <tr> <td>Starting</td> <td>Application started; at least one container running, awaiting results.</td> </tr> <tr> <td>Running</td> <td>All containers are running.</td> </tr> <tr> <td>Error</td> <td>All containers failed.</td> </tr> <tr> <td>Unknown</td> <td>Application started, no containers observed.</td> </tr> <tr> <td>Completed</td> <td>All containers have completed successfully.</td> </tr> </tbody> </table> <h3 id=managing-applications-on-the-web-ui>Managing Applications on the Web UI<a class=headerlink href=#managing-applications-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=managing-applications-on-the-cli>Managing Applications on the CLI<a class=headerlink href=#managing-applications-on-the-cli title="Permanent link">&para;</a></h3> <p>To deploy an application package from an OCI registry, specify it in the device's <code>spec.applications[]</code> as follows:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>  </span><span class=nt>applications</span><span class=p>:</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">wordpress</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/flightctl-demos/wordpress-app:latest</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>    </span><span class=nt>envVars</span><span class=p>:</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>      </span><span class=nt>WORDPRESS_DB_HOST</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mysql&quot;</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>      </span><span class=nt>WORDPRESS_DB_USER</span><span class=p>:</span><span class=w> </span><span class=s>&quot;user&quot;</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=w>      </span><span class=nt>WORDPRESS_DB_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s>&quot;password&quot;</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <h2 id=creating-applications>Creating Applications<a class=headerlink href=#creating-applications title="Permanent link">&para;</a></h2> <h3 id=creating-oci-registry-application-package>Creating OCI Registry Application Package<a class=headerlink href=#creating-oci-registry-application-package title="Permanent link">&para;</a></h3> <p>Define the application's functionality with the <a href=https://github.com/compose-spec/compose-spec/blob/main/spec.md>Compose specification</a> and embed the compose file in a scratch container. Add the <code>appType=compose</code> label, then build and push the container to your OCI registry. Finally, reference the image in <code>spec.applications[]</code>.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class="l l-Scalar l-Scalar-Plain">FROM scratch</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class="l l-Scalar l-Scalar-Plain">COPY podman-compose.yaml /podman-compose.yaml</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class="l l-Scalar l-Scalar-Plain"># required</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class="l l-Scalar l-Scalar-Plain">LABEL appType=&quot;compose&quot;</span>
</span></code></pre></div> <h3 id=specifying-applications-inline-in-the-device-spec>Specifying Applications Inline in the Device Spec<a class=headerlink href=#specifying-applications-inline-in-the-device-spec title="Permanent link">&para;</a></h3> <p>Application manifests are specified inline in a device's specification, so building an OCI Registry Application Package is not required.</p> <p>The Inline Application Provider accepts a list of application content with the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Path</td> <td>The relative path to the file on the device. Note that any existing file will be overwritten.</td> </tr> <tr> <td>Content (Optional)</td> <td>The plain text (UTF-8) or base64-encoded content of the file.</td> </tr> <tr> <td>ContentEncoding</td> <td>How the contents are encoded. Must be either "plain" or "base64". Defaults to "plain".</td> </tr> </tbody> </table> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>  </span><span class=nt>applications</span><span class=p>:</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>      </span><span class=nt>appType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">compose</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>      </span><span class=nt>inline</span><span class=p>:</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w>            </span><span class=no>version: &quot;3.8&quot;</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w>            </span><span class=no>services:</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w>              </span><span class=no>service1:</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=w>                </span><span class=no>image:  quay.io/flightctl-tests/alpine:v1</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=w>                </span><span class=no>command: [&quot;sleep&quot;, &quot;infinity&quot;]</span>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">podman-compose.yaml</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <blockquote> <p>[!NOTE] Inline compose applications can have at most two paths. The first should be named <code>podman-compose.yaml</code>, and the second (override) must be named <code>podman-compose.override.yaml</code>.</p> </blockquote> <h3 id=adding-application-volumes>Adding Application Volumes<a class=headerlink href=#adding-application-volumes title="Permanent link">&para;</a></h3> <blockquote> <p>[!NOTE] This feature requires the Flight Control Agent to run with <strong>Podman version 5.5 or higher</strong>.</p> </blockquote> <p>Applications can declare persistent data volumes that are populated from OCI artifacts. This allows delivering large datasets (such as ML models or static assets) as part of the application deployment.</p> <p>Volumes are declared under each application in the <code>volumes</code> field. These volumes are mounted into the application containers via the Compose <code>volumes</code> section.</p> <h4 id=specifying-volumes>Specifying Volumes<a class=headerlink href=#specifying-volumes title="Permanent link">&para;</a></h4> <p>Each volume definition includes:</p> <table> <thead> <tr> <th>Field</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td>Logical volume name. Must match the volume name referenced in the Compose file.</td> </tr> <tr> <td><code>image.reference</code></td> <td>Fully qualified OCI artifact reference containing the volume contents.</td> </tr> <tr> <td><code>image.pullPolicy</code></td> <td>(Optional) Defines pull behavior: <code>Always</code>, <code>IfNotPresent</code>, or <code>Never</code>. Defaults to <code>IfNotPresent</code> if not specified.</td> </tr> </tbody> </table> <blockquote> <p>[!IMPORTANT] In the Compose file, volumes must be declared as <code>external: true</code> to allow the agent to handle preparation and mounting.</p> </blockquote> <h4 id=example-inline-application-with-volume>Example Inline Application with Volume<a class=headerlink href=#example-inline-application-with-volume title="Permanent link">&para;</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=w>  </span><span class=nt>applications</span><span class=p>:</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-inline</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=w>      </span><span class=nt>appType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">compose</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=w>      </span><span class=nt>inline</span><span class=p>:</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">docker-compose.yaml</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=w>          </span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=w>            </span><span class=no>version: &quot;3.8&quot;</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=w>            </span><span class=no>services:</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=w>              </span><span class=no>service1:</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=w>                </span><span class=no>image: quay.io/flightctl-tests/alpine:v1</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=w>                </span><span class=no>command: [&quot;sleep&quot;, &quot;infinity&quot;]</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=w>                </span><span class=no>volumes:</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=w>                  </span><span class=no>- my-data:/data</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=w>            </span><span class=no>volumes:</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a><span class=w>              </span><span class=no>my-data:</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a><span class=w>                </span><span class=no>external: true</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-data</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=w>          </span><span class=nt>image</span><span class=p>:</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a><span class=w>            </span><span class=nt>reference</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/flightctl-tests/models/gpt2</span>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a><span class=w>            </span><span class=nt>pullPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
</span></code></pre></div> <h4 id=oci-artifact-requirements>OCI Artifact Requirements<a class=headerlink href=#oci-artifact-requirements title="Permanent link">&para;</a></h4> <p>Volume images must follow the OCI artifact specification:</p> <ul> <li>Published as OCI images (media type: <code>application/vnd.oci.image.manifest.v1+json</code>).</li> <li>Contain one or more layers representing the volume file contents.</li> <li>Hosted on any OCI-compatible registry accessible by the device.</li> </ul> <blockquote> <p>[!TIP] If the artifact contains more than one layer, the mount path should be an already existing directory, into which the layers will each be copied as a separate file using the name specified in the layer's <code>org.opencontainers.image.title</code> field. For single layer archives if the mount path does not exist as a directory the single layer will be extracted as a file at that path, otherwise it will be placed into the existing directory using the file name in the name field for the layer.</p> </blockquote> <h4 id=device-requirements>Device Requirements<a class=headerlink href=#device-requirements title="Permanent link">&para;</a></h4> <p>The following are required on the device to support application volumes:</p> <ul> <li>Podman <strong>5.5 or newer</strong> installed.</li> <li><code>podman-compose</code> installed.</li> <li>OCI registry authentication (if needed) must be configured prior to deployment.</li> </ul> <h2 id=using-device-lifecycle-hooks>Using Device Lifecycle Hooks<a class=headerlink href=#using-device-lifecycle-hooks title="Permanent link">&para;</a></h2> <p>You can use device lifecycle hooks to make the agent run user-defined commands at specific points in the device's lifecycle. For example, you can add a shell script to your OS images that backs up your application data and then specify that this script shall be run and complete successfully before the agent can start updating the system.</p> <p>The following device lifecycle hooks are supported:</p> <table> <thead> <tr> <th>Lifecycle Hook</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>beforeUpdating</code></td> <td>This hook is called after the agent completed preparing for the update and before actually making changes to the system. If an action in this hook returns with failure, the agent aborts the update.</td> </tr> <tr> <td><code>afterUpdating</code></td> <td>This hook is called after the agent has written the update to disk. If an action in this hook returns with failure,the agent will abort and roll back the update.</td> </tr> <tr> <td><code>beforeRebooting</code></td> <td>This hook is called before the agent reboots the device. The agent will block the reboot until running the action has completed or timed out. If any action in this hook returns with failure, the agent will abort and roll back the update.</td> </tr> <tr> <td><code>afterRebooting</code></td> <td>This hook is called when the agent first starts after a reboot. If any action in this hook returns with failure, the agent will report this but continue starting up.</td> </tr> </tbody> </table> <p>Refer to the <a href=../device-api-statuses/ >Device API status reference</a> a state diagram defining when each device lifecycle hook is called by the agent.</p> <p>Device lifecycle hooks can be defined by adding rule files to one of two locations in the device's filesystem, whereby <code>${lifecyclehook}</code> is the all-lower-case name of the hook to be defined:</p> <ul> <li>Rules in the <code>/usr/lib/flightctl/hooks.d/${lifecyclehook}/</code> drop-in directory are read-only and thus have to be added to the OS image during <a href=../building-images/ >image building</a>.</li> <li>Rules in the <code>/etc/flightctl/hooks.d/${lifecyclehook}/</code> drop-in directory are read-writable and can thus be updated at runtime using the methods described in <a href=#managing-os-configuration>Managing OS Configuration</a>.</li> </ul> <p>If rules are defined in both locations they will be merged, whereby files under <code>/etc</code> take precedence over files of the same name under <code>/usr</code>. If multiple rule files are added to a hook's directory, they are processed in lexical order of their file names.</p> <p>A rule file is written in YAML format and contains a list of one or more actions. An action can be to run an external command ("run action"). When multiple actions are specified for a hook, these actions are performed in sequence, finishing one action before starting the next. If an action returns with failure, later actions will not be executed.</p> <p>A run action takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Run</td> <td>The absolute path to the command to run, followed by any flags or arguments.<br><br>Example: <code>/usr/bin/nmcli connection reload</code>.<br><br>Note that the command is not executed in a shell, so you cannot use shell variables like <code>$FOO_PATH</code> or chain commands (<code>\|</code> or <code>;</code>). However, it is possible to start a shell yourself if necessary by specifying the shell as command to run.<br><br>Example: <code>/usr/bin/bash -c 'echo foo'</code></td> </tr> <tr> <td>EnvVars</td> <td>(Optional) A list of key/value-pairs to set as environment variables for the command.</td> </tr> <tr> <td>WorkDir</td> <td>(Optional) The directory the command will be run from.</td> </tr> <tr> <td>Timeout</td> <td>(Optional) The maximum duration allowed for the action to complete. The duration must be be specified as a single positive integer followed by a time unit. Supported time units are <code>s</code> for seconds, <code>m</code> for minutes, and <code>h</code> for hours.<br><br>Default: 10s</td> </tr> <tr> <td>If</td> <td>(Optional) A list of conditions that must be true for the action to be run (see below). If not provided, actions will run unconditionally.</td> </tr> </tbody> </table> <blockquote> <p>[!NOTE] When using a shell with <code>run</code>, the executed environment does not inherit the system environment, any required environment variables must be provided explicitly via the <code>envVars</code> field in the API.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>-<span class=w> </span>run:<span class=w> </span>/usr/bin/bash<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;until [ -f </span><span class=nv>$KUBECONFIG</span><span class=s2> ]; do sleep 1; done&quot;</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=w>   </span>timeout:<span class=w> </span>5m
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=w>   </span>envVars:
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=w>     </span>KUBECONFIG:<span class=w> </span><span class=s2>&quot;/var/lib/microshift/resources/kubeadmin/kubeconfig&quot;</span>
</span></code></pre></div> </blockquote> <p>By default, actions are performed every time the hook is triggered. However, for the <code>afterUpdating</code> hook you can use the <code>If</code> parameter to add conditions that must be true for an action to be performed, otherwise the action will be skipped.</p> <p>In particular, to only run an action if a given file or directory has changed during the update, you can define a "path condition" that takes the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Path</td> <td>An absolute path to a file or directory that must have changed during the update as condition for the action to be performed. Paths must be specified using forward slashes (<code>/</code>) and if the path is to a directory it must terminate with a forward slash <code>/</code>.<br>If you specify a path to a file, the file must have changed to satisfy the condition.If you specify a path to a directory, a file in that directory or any of its subdirectories must have changed to satisfy the condition.</td> </tr> <tr> <td>Op</td> <td>A list of file operations (<code>created</code>, <code>updated</code>, <code>removed</code>) to further limit the kind of changes to the specified path as condition for the action to be performed.</td> </tr> </tbody> </table> <p>If you have specified a "path condition" for an action in the <code>afterUpdating</code> hook, you have the following variables that you can include in arguments to your command and that will be replaced with the absolute path(s) to the changed files:</p> <table> <thead> <tr> <th>Variable</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>${ Path }</code></td> <td>The absolute path to the file or directory specified in the path condition.</td> </tr> <tr> <td><code>${ Files }</code></td> <td>A space-separated list of absolute paths of the files that were changed (created, updated, or removed) during the update and are covered by the path condition.</td> </tr> <tr> <td><code>${ CreatedFiles }</code></td> <td>A space-separated list of absolute paths of the files that were changed (created, updated, or removed) during the update and are covered by the path condition.</td> </tr> <tr> <td><code>${ UpdatedFiles }</code></td> <td>A space-separated list of absolute paths of the files that were updated during the update and are covered by the path condition.</td> </tr> <tr> <td><code>${ RemovedFiles }</code></td> <td>A space-separated list of absolute paths of the files that were removed during the update and are covered by the path condition.</td> </tr> </tbody> </table> <p>The Flight Control Agent comes with a built-in set of rules defined in <code>/usr/lib/flightctl/hooks.d/afterupdating/00-default.yaml</code>:</p> <table> <thead> <tr> <th>If files changed below</th> <th>then the agent runs</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>/etc/systemd/system/</code></td> <td><code>systemctl daemon-reload</code></td> <td>Changes to systemd units will be activated by signaling the systemd daemon to reload the systemd manager configuration. This will rerun all generators, reload all unit files, and recreate the entire dependency tree.</td> </tr> <tr> <td><code>/etc/NetworkManager/system-connections/</code></td> <td><code>nmcli conn reload</code></td> <td>Changes to Network Manager system connections will be activated by signaling Network Manager to reload all connections.</td> </tr> <tr> <td><code>/etc/firewalld/</code></td> <td><code>firewall-cmd --reload</code></td> <td>Changes to firewalld's permanent configuration will be activated by signaling firewalld to reload firewall rules as new runtime configuration.</td> </tr> </tbody> </table> <h2 id=monitoring-device-resources>Monitoring Device Resources<a class=headerlink href=#monitoring-device-resources title="Permanent link">&para;</a></h2> <p>You can set up monitors for device resources and define alerts when the utilization of these resources crosses a defined threshold. When the agent alerts the Flight Control service, the service sets the device status to "degraded" or "error" (depending on the severity level) and may suspend the rollout of updates and alarm the user as a result.</p> <p>Note this is not meant to replace an observability solution. If your use case requires streaming logs and metrics from devices into an observability stack and the device's network bandwidth allows this, see <a href=../service-observability/ >Service Observability</a> and <a href=../standalone-observability/ >Standalone Observability</a> for ways to approach that.</p> <p>Resource monitors take the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>MonitorType</td> <td>The resource to monitor. Currently supported resources are "CPU", "Memory", and "Disk". <strong>[TODO: Check whether the "Custom" resource type is implemented.]</strong></td> </tr> <tr> <td>SamplingInterval</td> <td>The interval in which the monitor samples utilization, specified as positive integer followed by a time unit ('s' for seconds, 'm' for minutes, 'h' for hours).</td> </tr> <tr> <td>AlertRules</td> <td>A list of alert rules.</td> </tr> <tr> <td>Path</td> <td>(Disk monitor only) The absolute path to the directory to monitor. Utilization reflects the filesystem containing the path, similar to df, even if itâ€™s not a mount point.</td> </tr> </tbody> </table> <p>Alert rules take the following parameters:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Severity</td> <td>The alert rule's severity level out of "Info", "Warning", or "Critical". Only one alert rule is allowed per severity level and monitor.</td> </tr> <tr> <td>Duration</td> <td>The duration that resource utilization is measured and averaged over when sampling, specified as positive integer followed by a time unit ('s' for seconds, 'm' for minutes, 'h' for hours). Must be smaller than the sampling interval.</td> </tr> <tr> <td>Percentage</td> <td>The utilization threshold that triggers the alert, as percentage value (range 0 to 100 without the "%" sign).</td> </tr> <tr> <td>Description</td> <td>A human-readable description of the alert. This is useful for adding details about the alert that might help with debugging. By default it populates the alert as <severity>: <type> load is above <percentage>&gt;% for more than <duration></td> </tr> </tbody> </table> <h3 id=monitoring-device-resources-on-the-web-ui>Monitoring Device Resources on the Web UI<a class=headerlink href=#monitoring-device-resources-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=monitoring-device-resources-on-the-cli>Monitoring Device Resources on the CLI<a class=headerlink href=#monitoring-device-resources-on-the-cli title="Permanent link">&para;</a></h3> <p>To monitor resource utilization, add resource monitors in the <code>resources:</code> section of the device's specification.</p> <p>For example, to monitor disk utilization on the filesystem associated with the path /applications, which can trigger a warning alert if the average utilization exceeds 75% for more than 30 minutes and a critical alert if it exceeds 90% for over 10 minutes with a sampling interval of 5 seconds.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">flightctl.io/v1alpha1</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Device</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">some_device_name</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=w>  </span><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>monitorType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Disk</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=w>    </span><span class=nt>samplingInterval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/application_data</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=w>    </span><span class=nt>alertRules</span><span class=p>:</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Warning</span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=w>      </span><span class=nt>duration</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30m</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=w>      </span><span class=nt>percentage</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">75</span>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Disk space for application data is &gt;75% full for over 30m.</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Critical</span>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a><span class=w>      </span><span class=nt>duration</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10m</span>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a><span class=w>      </span><span class=nt>percentage</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Disk space for application data is &gt;90% full over 10m.</span>
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <h2 id=accessing-devices-remotely>Accessing Devices Remotely<a class=headerlink href=#accessing-devices-remotely title="Permanent link">&para;</a></h2> <p>For troubleshooting an edge device, a user with the appropriate authorization (<code>get</code> permission on the <code>devices/console</code> resource) can remotely connect to the device's console through the agent. This does not require an SSH connection and so works even if that device is on a private network (behind a NAT), has a dynamic IP address, or has its SSH service disabled.</p> <h3 id=accessing-devices-on-the-web-ui>Accessing Devices on the Web UI<a class=headerlink href=#accessing-devices-on-the-web-ui title="Permanent link">&para;</a></h3> <h3 id=accessing-devices-on-the-cli>Accessing Devices on the CLI<a class=headerlink href=#accessing-devices-on-the-cli title="Permanent link">&para;</a></h3> <p>To connect, use the <code>flightctl console</code> command specifying the device's name, and the agent will establish the console connection the next time it calls home:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=go>flightctl console device/&lt;some_device_name&gt;</span>
</span></code></pre></div> <p>To disconnect, enter "exit" on the console. To force-disconnect, press newline followed by <code>~.</code> (tilde period).</p> <p>The console can be used to run commands on the device, for example to check the status of the flightctl-agent service:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=go>flightctl console device/&lt;some_device_name&gt; -- systemctl status flightctl-agent</span>
</span></code></pre></div> <p>The console can be used to download a file from the device to your local machine, for example to download the systemd journal log:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=go>flightctl console device/&lt;some_device_name&gt; -- journalctl -o short-precise --no-pager &gt; journal.log</span>
</span></code></pre></div> <h2 id=decommissioning-devices>Decommissioning Devices<a class=headerlink href=#decommissioning-devices title="Permanent link">&para;</a></h2> <p>Decommissioning a device is the proper way to unenroll it and permanently remove it from Flight Control management. When a user requests the decommissioning of a device, the Flight Control service signals to the Flight Control agent to run a decommissioning process. This process includes erasing the agent's management certificate and key and with it the device's Flight Control identity. This is an action that cannot be undone. Decommissioning should be performed before deleting a device.</p> <p>To decommission a device:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=go>flightctl decommission devices/&lt;some_device_name&gt;</span>
</span></code></pre></div> <p>You can see that the decommissioning request was properly received by the Flight Control service when it includes a decommissioning target in its device specification and its lifecycle status (<code>status.lifecycle.status</code>) moves to Decommissioning:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=gp>$ </span>flightctl<span class=w> </span>get<span class=w> </span>devices/&lt;some_device_name&gt;<span class=w> </span>-o<span class=w> </span>yaml
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=go>...</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=go>spec:</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=go>  decommissioning:</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=go>    target: Unenroll</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=go>...</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=go>status:</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=go>  ...</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a><span class=go>  lifecycle:</span>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a><span class=go>    status: Decommissioning</span>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=go>...</span>
</span></code></pre></div> <p>Once the device receives the decommissioning request from the server, it will acknowledge the request with a decommissioning <code>Condition</code> that can also be seen in the device info:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=gp>$ </span>flightctl<span class=w> </span>get<span class=w> </span>devices/&lt;some_device_name&gt;<span class=w> </span>-o<span class=w> </span>yaml
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=go>...</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=go>status:</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=go>...</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=go>  conditions:</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=go>  ...</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=go>    - lastTransitionTime: &quot;2025-03-05T20:40:48.443917332Z&quot;</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=go>    message: The device has completed decommissioning and will wipe its management</span>
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=go>      certificate</span>
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=go>    reason: Completed</span>
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a><span class=go>    status: &quot;True&quot;</span>
</span><span id=__span-35-13><a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a><span class=go>    type: DeviceDecommissioning</span>
</span></code></pre></div> <p>When the device has completed its decommissioning steps, the <code>status.lifecycle.status</code> field will show the value <code>Decommissioned</code>. At this point, it is safe to delete the device with:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=go>flightctl delete devices/&lt;some_device_name&gt;</span>
</span></code></pre></div> <h2 id=scheduling-updates-and-downloads>Scheduling Updates and Downloads<a class=headerlink href=#scheduling-updates-and-downloads title="Permanent link">&para;</a></h2> <p>The Flight Control agent supports time-based scheduling for update and download operations using cron style expressions. This allows you to restrict system modifications to defined maintenance windows or operational periods.</p> <p>Each device can define two independent schedules in the <code>updatePolicy</code> section of the <code>DeviceSpec</code>:</p> <ul> <li><strong><code>downloadSchedule</code></strong>: Defines when the device is allowed to download update artifacts such as OS image layers.</li> <li><strong><code>updateSchedule</code></strong>: Defines when the device is allowed to apply updates.</li> </ul> <p>Each schedule supports:</p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>at</code></td> <td>A <a href=https://man7.org/linux/man-pages/man5/crontab.5.html>cron expression</a> specifying valid run times.</td> </tr> <tr> <td><code>timeZone</code></td> <td>(Optional) The time zone used to evaluate the schedule. Defaults to the deviceâ€™s local system time zone. Must be a valid <a href=https://en.wikipedia.org/wiki/List_of_tz_database_time_zones>IANA time zone</a>.</td> </tr> <tr> <td><code>startGraceDuration</code></td> <td>(Optional) A duration string that extends the allowed start time window after a schedule trigger. Follows the <a href=https://pkg.go.dev/time#ParseDuration>Go duration format</a>, such as <code>"1h"</code> or <code>"45m"</code>.</td> </tr> </tbody> </table> <p>The Flight Control agent evaluates these schedules during its control loop to determine whether each policy is currently allowed to proceed. While the device waits for the update window the device status will read <code>OutOfDate</code>. For more details please see <a href=../device-api-statuses/#device-api-statuses>Device API Statuses</a>.</p> <blockquote> <p>[!TIP] Use <a href=https://crontab.guru/ >crontab guru</a> to create and test cron expressions interactively.</p> </blockquote> <h3 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=nt>updatePolicy</span><span class=p>:</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=w>  </span><span class=nt>downloadSchedule</span><span class=p>:</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>    </span><span class=nt>at</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0</span><span class=nv> </span><span class=s>2</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*&quot;</span><span class=w>               </span><span class=c1># every day at 2:00 AM</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>    </span><span class=nt>timeZone</span><span class=p>:</span><span class=w> </span><span class=s>&quot;America/New_York&quot;</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>    </span><span class=nt>startGraceDuration</span><span class=p>:</span><span class=w> </span><span class=s>&quot;30m&quot;</span><span class=w>     </span><span class=c1># allow downloads until 2:30 AM</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>  </span><span class=nt>updateSchedule</span><span class=p>:</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>    </span><span class=nt>at</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0</span><span class=nv> </span><span class=s>4</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>1&quot;</span><span class=w>               </span><span class=c1># every Monday at 4:00 AM</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>    </span><span class=nt>timeZone</span><span class=p>:</span><span class=w> </span><span class=s>&quot;America/New_York&quot;</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=w>    </span><span class=nt>startGraceDuration</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1h&quot;</span><span class=w>      </span><span class=c1># allow update until 5:00 AM</span>
</span></code></pre></div> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=nt>updatePolicy</span><span class=p>:</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=w>  </span><span class=nt>updateSchedule</span><span class=p>:</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=w>    </span><span class=nt>at</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0</span><span class=nv> </span><span class=s>5</span><span class=nv> </span><span class=s>14</span><span class=nv> </span><span class=s>5</span><span class=nv> </span><span class=s>*&quot;</span><span class=w>              </span><span class=c1># May 15th at 5:00 AM</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=w>    </span><span class=nt>timeZone</span><span class=p>:</span><span class=w> </span><span class=s>&quot;America/New_York&quot;</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=w>    </span><span class=nt>startGraceDuration</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2h&quot;</span><span class=w>      </span><span class=c1># allow update until 7:00 AM</span>
</span></code></pre></div> <blockquote> <p>[!NOTE] Itâ€™s best practice to define a <code>startGraceDuration</code> to allow for potential delays in agent execution. Without it, the update window may be missed. Once an update begins within the allowed window, there is no enforced timeout the update may continue running beyond the grace period.</p> </blockquote> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../install-cli/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Install CLI"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Install CLI </div> </div> </a> <a href=../managing-fleets/ class="md-footer__link md-footer__link--next" aria-label="Next: Managing Fleets"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Managing Fleets </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/flightctl/flightctl target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.56ea9cef.min.js></script> </body> </html>